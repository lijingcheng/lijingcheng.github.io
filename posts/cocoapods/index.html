<!doctype html><html lang=zh-cn><head><title>使用 CocoaPods 做依赖管理 // 风行's Blog</title><meta charset=utf-8><meta name=generator content="Hugo 0.61.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="风行"><meta name=description content><link rel=stylesheet href=https://lijingcheng.github.io/css/main.min.61bb32028587f24ca28522d8d197970c7ef33284e5fffb45a75fcbbb2dbc4dcb.css><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 CocoaPods 做依赖管理"><meta name=twitter:description content="CocoaPods 可以为 iOS 项目使用的第三方类库和我们自己的私有类库提供依赖管理，我们只需要告诉它要使用的类库名称和版本号，然后再执行一条命令，它就会自动将这个类库的源码下载到本地，并且为工程设置好相应的系统依赖和编译项。
准备工作 由于 CocoaPods 是用 ruby 写的，所以需要有 ruby 环境和 git 环境，尽量使用 rvm 来管理 ruby，可避免因权限导致的 gem install 失败问题。
sudo gem update –system 为了提高下载速度，还需要将 ruby 源更改为国内地址
gem sources -a https://gems.ruby-china.com/ -r https://rubygems.org/ gem sources -l 安装并使用 CocoaPods 安装 CocoaPods
sudo gem install cocoapods (更新也用这个) 下载 CocoaPods 维护的所有 podspec 文件到&#34;~/.cocoapods/repos/master/Specs&rdquo;，podspec 文件主要用来描述依赖库的名称、版本、作者、下载地址等信息。通过 CocoaPods 下载第三方类库，其实就是根据我们指定的类库名称找到相关的 podspec，然后再根据 podspec 文件中指定的地址去下载。
pod setup 查看 CocoaPods 管理的依赖库信息
pod search 依赖库的名字 新建 Podfile 文件，此文件用于配置项目所需要使用的依赖库
cd &#34;项目根目录&#34; pod init 打开 Podfile 文件，按下面内容配置依赖关系，Podfile 的更详细配置方法可参照官方文档"><meta property="og:title" content="使用 CocoaPods 做依赖管理"><meta property="og:description" content="CocoaPods 可以为 iOS 项目使用的第三方类库和我们自己的私有类库提供依赖管理，我们只需要告诉它要使用的类库名称和版本号，然后再执行一条命令，它就会自动将这个类库的源码下载到本地，并且为工程设置好相应的系统依赖和编译项。
准备工作 由于 CocoaPods 是用 ruby 写的，所以需要有 ruby 环境和 git 环境，尽量使用 rvm 来管理 ruby，可避免因权限导致的 gem install 失败问题。
sudo gem update –system 为了提高下载速度，还需要将 ruby 源更改为国内地址
gem sources -a https://gems.ruby-china.com/ -r https://rubygems.org/ gem sources -l 安装并使用 CocoaPods 安装 CocoaPods
sudo gem install cocoapods (更新也用这个) 下载 CocoaPods 维护的所有 podspec 文件到&#34;~/.cocoapods/repos/master/Specs&rdquo;，podspec 文件主要用来描述依赖库的名称、版本、作者、下载地址等信息。通过 CocoaPods 下载第三方类库，其实就是根据我们指定的类库名称找到相关的 podspec，然后再根据 podspec 文件中指定的地址去下载。
pod setup 查看 CocoaPods 管理的依赖库信息
pod search 依赖库的名字 新建 Podfile 文件，此文件用于配置项目所需要使用的依赖库
cd &#34;项目根目录&#34; pod init 打开 Podfile 文件，按下面内容配置依赖关系，Podfile 的更详细配置方法可参照官方文档"><meta property="og:type" content="article"><meta property="og:url" content="https://lijingcheng.github.io/posts/cocoapods/"><meta property="article:published_time" content="2015-02-11T15:10:58+08:00"><meta property="article:modified_time" content="2015-02-11T15:10:58+08:00"></head><body><header class=app-header><a href=https://lijingcheng.github.io><img class=app-header-avatar src=/images/avatar.png alt=风行></a><h1>风行's Blog</h1><p>Do not repeat yourself!</p><div class=app-header-social><a target=_blank href=https://github.com/lijingcheng rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a target=_blank href=https://www.instagram.com/bj_lijingcheng/ rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-instagram"><title>instagram</title><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"/><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>使用 CocoaPods 做依赖管理</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Feb 11, 2015</div></div></header><div class=post-content><p><a href=http://www.cocoapods.org>CocoaPods</a> 可以为 iOS 项目使用的第三方类库和我们自己的私有类库提供依赖管理，我们只需要告诉它要使用的类库名称和版本号，然后再执行一条命令，它就会自动将这个类库的源码下载到本地，并且为工程设置好相应的系统依赖和编译项。</p><h1 id=heading>准备工作</h1><p>由于 CocoaPods 是用 ruby 写的，所以需要有 ruby 环境和 git 环境，尽量使用 rvm 来管理 ruby，可避免因权限导致的 gem install 失败问题。</p><pre><code>sudo gem update –system
</code></pre><p>为了提高下载速度，还需要将 ruby 源更改为国内地址</p><pre><code>gem sources -a https://gems.ruby-china.com/ -r https://rubygems.org/
gem sources -l
</code></pre><h1 id=-cocoapods>安装并使用 CocoaPods</h1><p>安装 CocoaPods</p><pre><code>sudo gem install cocoapods (更新也用这个)
</code></pre><p>下载 CocoaPods 维护的所有 podspec 文件到"~/.cocoapods/repos/master/Specs&rdquo;，podspec 文件主要用来描述依赖库的名称、版本、作者、下载地址等信息。通过 CocoaPods 下载第三方类库，其实就是根据我们指定的类库名称找到相关的 podspec，然后再根据 podspec 文件中指定的地址去下载。</p><pre><code>pod setup
</code></pre><p>查看 CocoaPods 管理的依赖库信息</p><pre><code>pod search 依赖库的名字
</code></pre><p>新建 Podfile 文件，此文件用于配置项目所需要使用的依赖库</p><pre><code>cd &quot;项目根目录&quot;
pod init
</code></pre><p>打开 Podfile 文件，按下面内容配置依赖关系，Podfile 的更详细配置方法可参照<a href=http://guides.cocoapods.org/syntax/podfile.html>官方文档</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>source <span style=color:#e6db74>&#39;https://github.com/CocoaPods/Specs.git&#39;</span>

platform <span style=color:#e6db74>:ios</span>, <span style=color:#e6db74>&#39;7.0&#39;</span>
inhibit_all_warnings!

target <span style=color:#e6db74>&#39;xxx&#39;</span> <span style=color:#66d9ef>do</span>
  pod <span style=color:#e6db74>&#39;AFNetworking&#39;</span>, <span style=color:#e6db74>&#39;2.5.1&#39;</span> 
<span style=color:#66d9ef>end</span>
</code></pre></div><p>上面内容的意思是，specs 文件由 CocoaPods 提供，项目需要使用支持 ios7.0 及以上的依赖库，并且为指定 target 配置了 2.5.1 版本的 AFNetworking，并忽略依赖库中的所有警告。依赖库的版本号建议明确指定，这样可以避免更新依赖库后对现有工程造成影响，而且可以保证团队所有开发人员使用的版本一致。</p><p>根据 Podfile 文件内容下载安装依赖库</p><pre><code>pod install
</code></pre><p>执行完成后 CocoaPods 会自动为项目工程设置好相应的系统依赖和编译参数，当依赖库安装完成后，打开项目根目录，会发现多了以下文件及文件夹</p><ul><li>&ldquo;.xcworkspace&rdquo;，以后必须通过此 workspace 打开项目。</li><li>&ldquo;Pods&rdquo;，CocoaPods 将 Profile 中配置的所有依赖库都下载到这里，并且将所有依赖库打包成单独的静态库供主项目使用。</li><li>&ldquo;Podfile.lock&rdquo;，用于保存已经安装的依赖库版本信息。如果在配置依赖库时没有明确指定版本，那么必须将此文件加入到版本控制中，否则有可能造成团队开发中不同成员使用的依赖库版本不一致。</li></ul><p>查看所下载的依赖库是否有新版本</p><pre><code>pod outdated
</code></pre><p>更新本地 podspec 仓库并更新依赖库</p><pre><code>pod update
</code></pre><p>更新依赖库且不更新本地 podspec 仓库（速度会快很多）</p><pre><code>pod update --no-repo-update
</code></pre><p>将 CocoaPods 从项目中移除，并还原其对 Xcode 的配置修改（1.0 版本开始支持，以前需要用第三方提供的方式）</p><pre><code>pod deintegrate
</code></pre><h1 id=-cocoapods-1>让自己的开源项目支持 CocoaPods</h1><p>通过 CocoaPods 创建项目会让整个事情变的简单一些</p><pre><code>pod lib create FMDBHelper
</code></pre><p>创建完成后项目根目录会包含以下文件及文件夹</p><ul><li>&ldquo;.travis.yml&rdquo;，通过 travis-ci 做持续集成要用到的配置文件，一般情况下使用默认配置就可以，如果需要使用持续集成服务，还需要以 GitHub 帐号登录 <a href=https://travis-ci.org>travis-ci</a>，并打开对应项目开关。</li><li>&ldquo;.gitignore&rdquo;，建议将 Pods 目录也加入到忽略范围</li><li>&ldquo;LICENSE&rdquo;，默认为 MIT</li><li>&ldquo;FMDBHelper.podspec&rdquo;，通过 Cocoapods 下载项目时要用到的项目配置文件。</li><li>&ldquo;README.md&rdquo;，通过 markdown 语法编写此文件，用于在 GitHub 上显示项目介绍。</li><li>&ldquo;Pod&rdquo;，将自己的开源代码和资源文件放到这里</li><li>&ldquo;Example&rdquo;，demo 工程，包含测试用的 target。</li></ul><p>在 demo 工程中开发并测试</p><ul><li>将源代码和资源文件分别放到 Pod/Classes 和 Pod/Assets 目录下</li><li>用 pod install 命令为 demo 工程安装依赖库，以后只要新增依赖库的代码或资源文件都需要更新</li><li>开发测试完成后还需要修改 podspec 文件</li></ul><p>在将 podspec 发布到 CocoaPods 的 Git 库之前首先向 CocoaPods 注册你的信息，需要输入邮箱(与 podspec 中写的一致)和名字，稍后还需要验证 email</p><pre><code>pod trunk register bj_lijingcheng@163.com &quot;lijingcheng&quot;
</code></pre><p>登录 GitHub，release 一版项目并打上标签，标签要与 podspec 中定义的一致，检查并发布 spec 文件，以后需要升级版本时也是用这个命令</p><pre><code>pod trunk push FMDBHelper.podspec
</code></pre><p>更新本地 spec</p><pre><code>pod repo update
</code></pre><h1 id=-cocoapods->通过 CocoaPods 维护私有库</h1><p>可以按<a href=https://guides.cocoapods.org/making/private-cocoapods.html>官方指导</a>来做，大致步骤与在 GitHub 上维护开源项目相似，区别如下：</p><ul><li><p>需要通过 Git 建立自己的 spec 仓库，并在 Podfile 文件中填加 source</p></li><li><p>通过 pod repo 来查看现有的 spec 仓库</p></li><li><p>通过 pod repo add repo_name source_url 在 ~/.cocoapods/repos/ 目录下新建自己的 spec 仓库</p></li><li><p>通过 pod repo push &ndash;allow-warnings repo_name spec_name.podspec 命令将已经写好的 podspec 文件填加到 spec 仓库中</p></li><li><p>私有库新增版本后需要打 tag 并修改 podspec 文件中的 version，然后再次更新 spec 仓库</p></li><li><p>在 Podfile 中可直接通过 pod repo_name 安装私有库</p></li></ul></div><div class=post-footer></div></article></main></body></html>